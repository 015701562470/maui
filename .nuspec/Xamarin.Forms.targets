<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

	<UsingTask TaskName="Xamarin.Forms.Build.Tasks.XamlGTask" AssemblyFile="$(MSBuildThisFileDirectory)Xamarin.Forms.Build.Tasks.dll" />
	<UsingTask TaskName="Xamarin.Forms.Build.Tasks.CssGTask" AssemblyFile="$(MSBuildThisFileDirectory)Xamarin.Forms.Build.Tasks.dll"/>
	<UsingTask TaskName="Xamarin.Forms.Build.Tasks.XamlCTask" AssemblyFile="$(MSBuildThisFileDirectory)Xamarin.Forms.Build.Tasks.dll" />
	<UsingTask TaskName="Xamarin.Forms.Build.Tasks.GetTasksAbi" AssemblyFile="$(MSBuildThisFileDirectory)Xamarin.Forms.Build.Tasks.dll" />

	<PropertyGroup>
		<EnableDefaultXamlItems Condition="'$(EnableDefaultXamlItems)'==''">True</EnableDefaultXamlItems>
		<_DefaultXamlItemsEnabled>False</_DefaultXamlItemsEnabled>
	</PropertyGroup>

	<Import Project="$(MSBuildThisFileDirectory)Xamarin.Forms.DefaultItems.targets" Condition="'$(MSBuildSDKsPath)'!='' And '$(EnableDefaultItems)'=='true' " />

	<PropertyGroup>
		<CoreCompileDependsOn>
			XamlG;
			$(CoreCompileDependsOn);
		</CoreCompileDependsOn>
	</PropertyGroup>

	<Target Name="XamlG" BeforeTargets="BeforeCompile" Condition="'$(_XamlGAlreadyExecuted)'!='true'">
		<PropertyGroup>
			<_XamlGAlreadyExecuted>true</_XamlGAlreadyExecuted>
		</PropertyGroup>
		<XamlGTask
			XamlFiles="@(EmbeddedResource)" Condition="'%(Extension)' == '.xaml' AND '$(DefaultLanguageSourceExtension)' == '.cs'"
			Language = "$(Language)"
			AssemblyName = "$(AssemblyName)"
			OutputPath = "$(IntermediateOutputPath)">
			<Output ItemName="FilesWrite" TaskParameter="GeneratedCodeFiles" />
			<Output ItemName="Compile" TaskParameter="GeneratedCodeFiles" />
		</XamlGTask>
	</Target>

	<!-- XamlC -->
	<PropertyGroup>
		<CompileDependsOn>
			$(CompileDependsOn);
			XamlC;
		</CompileDependsOn>
	</PropertyGroup>

	<Target Name="XamlC" AfterTargets="AfterCompile" Condition="'$(_XamlCAlreadyExecuted)'!='true'">
		<PropertyGroup>
			<_XamlCAlreadyExecuted>true</_XamlCAlreadyExecuted>
		</PropertyGroup>
		<XamlCTask
			Assembly = "$(IntermediateOutputPath)$(TargetFileName)"
			ReferencePath = "@(ReferencePath)"
			OptimizeIL = "true"
			DebugSymbols = "$(DebugSymbols)"
			DebugType = "$(DebugType)"
			KeepXamlResources = "$(XFKeepXamlResources)" />
	</Target>

	<!-- CssG -->
	<PropertyGroup>
		<CoreCompileDependsOn>
			CssG;
			$(CoreCompileDependsOn);
		</CoreCompileDependsOn>
	</PropertyGroup>
	<Target Name="CssG" BeforeTargets="BeforeCompile" Condition="'$(_CssGAlreadyExecuted)'!='true'">
		<PropertyGroup>
			<_CssGAlreadyExecuted>true</_CssGAlreadyExecuted>
		</PropertyGroup>
		<CssGTask
			XamlFiles="@(EmbeddedResource)" Condition="'%(Extension)' == '.css' AND '$(DefaultLanguageSourceExtension)' == '.cs'"
			Language = "$(Language)"
			AssemblyName = "$(AssemblyName)"
			OutputPath = "$(IntermediateOutputPath)">
			<Output ItemName="FilesWrite" TaskParameter="GeneratedCodeFiles" />
			<Output ItemName="Compile" TaskParameter="GeneratedCodeFiles" />
		</CssGTask>
	</Target>
</Project>
